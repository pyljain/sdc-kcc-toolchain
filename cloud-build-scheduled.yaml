steps:
- id: 'Clone repo'
  # This step fetches the policies from the repository
  name: 'gcr.io/cloud-builders/git'
  args: ['clone', 'https://github.com/pyljain/sdc-kcc-toolchain.git']
- id: 'Create new branch'
  # This step fetches the policies from the repository
  name: 'gcr.io/cloud-builders/git'
  args: ['checkout', '-b', 'recommendations-$BUILD_ID']
- id: 'Get the number of setters'
  # This step fetches the policies from the repository
  name: 'gcr.io/kpt-dev/kpt:latest'
  entrypoint: '/bin/sh'
  args: ['-c', 'kpt cfg list-setters manifests/']
- id: 'Set namespace in manifests'
  # This step fetches the policies from the repository
  name: 'gcr.io/kpt-dev/kpt:latest'
  entrypoint: '/bin/sh'
  args: ['-c', 'kpt cfg set manifests/ namespace ${_NAMESPACE_NAME} -R']
- id: 'Set projectId in manifests'
  # This step fetches the policies from the repository
  name: 'gcr.io/kpt-dev/kpt:latest'
  entrypoint: '/bin/sh'
  args: ['-c', 'kpt cfg set manifests/ projectid sandbox-jainpayal -R']
- id: 'Run recommender function'
  name: 'gcr.io/kpt-dev/kpt'
  args: ['-c', 'kpt fn run ./manifests/ --fn-path ./kpt']
  entrypoint: '/bin/sh'
- id: 'Create new branch'
  # This step fetches the policies from the repository
  name: 'gcr.io/cloud-builders/git'
  args: ['commit', '-am', 'Added recommendations']
- id: 'Push branch to remote'
  # This step fetches the policies from the repository
  name: 'gcr.io/cloud-builders/git'
  args: ['push', 'origin', 'recommendations-$BUILD_ID']
# - id: 'Validate against policies'
  # This step validates resources against recommendations - do the docker way
  # name: 'gcr.io/kpt-dev/kpt'
  # args: ['-c', 'kpt fn run ../manifests/ --enable-exec --exec-path ./activeassist_run-macos']
# - id: "Run functions"
#   name: 'gcr.io/kpt-dev/kpt:latest'
#   args:
#     - fn
#     - run
    # - exmaple-package